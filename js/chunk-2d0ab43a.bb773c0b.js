(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ab43a"],{1511:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container py-5"},[r("UserProfileCard",{attrs:{user:e.user,"is-followed":e.isFollowed,"is-current-user":e.isCurrentUser}}),r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-4"},[r("UserFollowingsCard",{attrs:{followings:e.user.followings}}),r("UserFollowersCard",{attrs:{followers:e.user.followers}})],1),r("div",{staticClass:"col-md-8"},[r("UserCommentsCard",{attrs:{comments:e.user.comments}}),r("UserFavoritedRestaurantsCard",{attrs:{favoriteRestaurants:e.user.favoriteRestaurants}})],1)])],1)},a=[],n=r("1da1"),o=r("5530"),i=(r("96cf"),r("b0c0"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"card mb-3"},[r("div",{staticClass:"row no-gutters"},[r("div",{staticClass:"col-md-4"},[r("img",{attrs:{src:e._f("emptyImage")(e.user.image),alt:""}})]),r("div",{staticClass:"col-md-8"},[r("div",{staticClass:"card-body"},[r("h4",{staticClass:"card-title"},[e._v(e._s(e.user.name))]),r("p",[e._v(e._s(e.user.email))]),r("ul",{staticClass:"list-unstyled"},[r("li",[r("strong",[e._v(e._s(e.user.comments.length))]),e._v(" 已評論餐廳 ")]),r("li",[r("strong",[e._v(e._s(e.user.favoriteRestaurants.length))]),e._v(" 收藏的餐廳 ")]),r("li",[r("strong",[e._v(e._s(e.user.followings.length))]),e._v(" followings(追蹤中) ")]),r("li",[r("strong",[e._v(e._s(e.user.followers.length))]),e._v(" followers(追蹤者) ")])]),e.isCurrentUser?[r("router-link",{staticClass:"btn btn-primary",attrs:{to:{name:"user-edit",params:{id:e.user.id}}}},[e._v(" Edit ")])]:[e.isUserFollowed?r("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteFollowing(e.user.id)}}},[e._v(" 取消追蹤 ")]):r("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addFollowing(e.user.id)}}},[e._v(" 追蹤 ")])]],2)])])])}),l=[],c=r("4cce"),u=r("2fa3"),d=r("2708"),m={name:"UserProfileCard",mixins:[d["a"]],props:{user:{type:Object,required:!0},isCurrentUser:{type:Boolean,default:!1},isFollowed:{type:Boolean,default:!1}},watch:{isFollowed:function(e){this.isUserFollowed=e}},data:function(){return{isUserFollowed:!1}},methods:{deleteFollowing:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,c["a"].deleteFollowing({userId:e});case 3:if(s=r.sent,a=s.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:t.isUserFollowed=!1,console.log(a),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),u["a"].fire({icon:"error",title:"無法移除追蹤使用者--".concat(r.t0.message)}),console.log(r.t0);case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},addFollowing:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,c["a"].addFollowing({userId:e});case 3:if(s=r.sent,a=s.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:t.isUserFollowed=!0,console.log(a),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),u["a"].fire({icon:"error",title:"無法追蹤使用者--".concat(r.t0.message)}),console.log(r.t0);case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()}}},f=m,g=r("2877"),v=Object(g["a"])(f,i,l,!1,null,null,null),w=v.exports,p=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"card mb-3"},[r("div",{staticClass:"card-header"},[r("strong",[e._v(e._s(e.followings.length))]),e._v(" followings (追蹤者)")]),r("div",{staticClass:"card-body"},e._l(e.followings,(function(t){return r("router-link",{key:t.id,attrs:{to:{name:"user",params:{id:t.id}}}},[r("img",{staticClass:"m-1",attrs:{src:e._f("emptyImage")(t.image),alt:"following",width:"60",height:"60"}})])})),1)])},h=[],C={name:"UserFollowingCard",mixins:[d["a"]],props:{followings:{type:Array,required:!0}}},_=C,b=Object(g["a"])(_,p,h,!1,null,null,null),y=b.exports,U=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"card mb-3"},[r("div",{staticClass:"card-header"},[r("strong",[e._v(e._s(e.followers.length))]),e._v(" followers (追蹤中)")]),r("div",{staticClass:"card-body"},e._l(e.followers,(function(t){return r("router-link",{key:t.id,attrs:{to:{name:"user",params:{id:t.id}}}},[r("img",{staticClass:"m-1",attrs:{src:e._f("emptyImage")(t.image),alt:"follower",width:"60",height:"60"}})])})),1)])},F=[],x={name:"UserFollowerCard",mixins:[d["a"]],props:{followers:{type:Array,required:!0}}},k=x,R=Object(g["a"])(k,U,F,!1,null,null,null),O=R.exports,j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"card mb-3"},[r("div",{staticClass:"card-header"},[r("strong",[e._v(e._s(e.comments.length))]),e._v(" (已評論餐廳)")]),r("div",{staticClass:"card-body"},e._l(e.comments,(function(t){return r("router-link",{key:t.id,attrs:{to:{name:"restaurant",params:{id:t.Restaurant.id}}}},[r("img",{staticClass:"m-1",attrs:{src:e._f("emptyImage")(t.Restaurant.image),alt:"following",width:"60",height:"60"}})])})),1)])},E=[],I={name:"UserCommentsCard",mixins:[d["a"]],props:{comments:{type:Array,required:!0}}},A=I,$=Object(g["a"])(A,j,E,!1,null,null,null),q=$.exports,P=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"card mb-3"},[r("div",{staticClass:"card-header"},[r("strong",[e._v(e._s(e.favoriteRestaurants.length))]),e._v(" (收藏的餐廳)")]),r("div",{staticClass:"card-body"},e._l(e.favoriteRestaurants,(function(t){return r("router-link",{key:t.id,attrs:{to:{name:"restaurant",params:{id:t.id}}}},[r("img",{staticClass:"m-1",attrs:{src:e._f("emptyImage")(t.image),alt:"following",width:"60",height:"60"}})])})),1)])},B=[],D={name:"UserFavoritedRestaurantsCard",mixins:[d["a"]],props:{favoriteRestaurants:{type:Array,required:!0}}},J=D,K=Object(g["a"])(J,P,B,!1,null,null,null),T=K.exports,z=r("2f62"),G={name:"User",components:{UserProfileCard:w,UserFollowingsCard:y,UserFollowersCard:O,UserCommentsCard:q,UserFavoritedRestaurantsCard:T},data:function(){return{user:{id:1,name:"",email:"",isAdmin:!1,image:"",comments:[],favoriteRestaurants:[],followers:[],followings:[]},isFollowed:!1,userId:0}},computed:Object(o["a"])(Object(o["a"])({},Object(z["b"])(["currentUser"])),{},{isCurrentUser:function(){return this.currentUser.id===this.user.id}}),created:function(){var e=this.$route.params.id;this.fetchUser(e)},beforeRouteUpdate:function(e,t,r){var s=e.params.id;this.fetchUser(s),r()},methods:{fetchUser:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s,a,n,o,i,l,d,m,f,g,v;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,c["a"].get({userId:e});case 3:if(s=r.sent,"OK"===s.statusText){r.next=6;break}throw new Error;case 6:console.log(s),a=s.data.profile,n=a.id,o=a.name,i=a.email,l=a.isAdmin,d=a.image,m=a.Comments,f=a.FavoritedRestaurants,g=a.Followers,v=a.Followings,t.isFollowed=s.data.isFollowed,t.user={id:n,name:o,email:i,isAdmin:l,image:d,comments:m||[],favoriteRestaurants:f||[],followers:g||[],followings:v||[]},r.next=16;break;case 12:r.prev=12,r.t0=r["catch"](0),u["a"].fire({icon:"error",title:"無法取得個人資訊，請稍後再試"}),console.log(r.t0);case 16:case"end":return r.stop()}}),r,null,[[0,12]])})))()}}},H=G,L=Object(g["a"])(H,s,a,!1,null,null,null);t["default"]=L.exports}}]);
//# sourceMappingURL=chunk-2d0ab43a.bb773c0b.js.map